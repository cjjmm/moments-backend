import{d as B,r as u,m as M,c as I,e,w as l,g as n,v as U,b as d,x as N,i as c,y as T,z as A,t as _,l as E,A as Y,E as S,B as V,o as v,_ as j}from"./index-Cr_upECF.js";const F={class:"user-management"},H={class:"search-bar"},R={class:"pagination"},$=B({__name:"Users",setup(L){const p=u(!1),m=u([]),r=u({page:1,size:10,total:0}),i=async()=>{p.value=!0;try{const a=await U({page:r.value.page,size:r.value.size});a.code===200&&a.data&&(m.value=a.data.list,r.value.total=a.data.total)}catch(a){console.error("Failed to fetch users:",a)}finally{p.value=!1}},h=a=>{E.confirm(`确定要删除用户 "${a.nickname||a.username}" 吗?删除后无法恢复!`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{(await Y(a.userId)).code===200&&(S.success("删除成功"),await i())}catch(s){console.error("Failed to delete user:",s)}})},b=a=>V(a).format("YYYY-MM-DD HH:mm:ss");return M(()=>{i()}),(a,s)=>{const y=n("Refresh"),w=n("el-icon"),g=n("el-button"),o=n("el-table-column"),z=n("el-avatar"),f=n("el-tag"),x=n("el-table"),D=n("el-pagination"),C=n("el-card"),k=T("loading");return v(),I("div",F,[e(C,null,{header:l(()=>[...s[2]||(s[2]=[d("div",{class:"card-header"},[d("span",null,"用户列表")],-1)])]),default:l(()=>[d("div",H,[e(g,{type:"primary",onClick:i},{default:l(()=>[e(w,null,{default:l(()=>[e(y)]),_:1}),s[3]||(s[3]=c(" 刷新 ",-1))]),_:1})]),N((v(),A(x,{data:m.value,style:{width:"100%"},stripe:""},{default:l(()=>[e(o,{prop:"userId",label:"用户ID",width:"80"}),e(o,{label:"头像",width:"80"},{default:l(({row:t})=>[e(z,{size:40,src:t.avatar},null,8,["src"])]),_:1}),e(o,{prop:"username",label:"用户名",width:"150"}),e(o,{prop:"nickname",label:"昵称",width:"150"}),e(o,{prop:"role",label:"角色",width:"100"},{default:l(({row:t})=>[e(f,{type:t.role==="ADMIN"?"danger":"success"},{default:l(()=>[c(_(t.role==="ADMIN"?"管理员":"普通用户"),1)]),_:2},1032,["type"])]),_:1}),e(o,{prop:"status",label:"状态",width:"100"},{default:l(({row:t})=>[e(f,{type:t.status===1?"success":"danger"},{default:l(()=>[c(_(t.status===1?"正常":"禁用"),1)]),_:2},1032,["type"])]),_:1}),e(o,{prop:"postCount",label:"发帖数",width:"100"}),e(o,{prop:"createTime",label:"注册时间",width:"180"},{default:l(({row:t})=>[c(_(b(t.createTime)),1)]),_:1}),e(o,{label:"操作",width:"150",fixed:"right"},{default:l(({row:t})=>[e(g,{type:"danger",size:"small",disabled:t.role==="ADMIN",onClick:P=>h(t)},{default:l(()=>[...s[4]||(s[4]=[c(" 删除 ",-1)])]),_:1},8,["disabled","onClick"])]),_:1})]),_:1},8,["data"])),[[k,p.value]]),d("div",R,[e(D,{"current-page":r.value.page,"onUpdate:currentPage":s[0]||(s[0]=t=>r.value.page=t),"page-size":r.value.size,"onUpdate:pageSize":s[1]||(s[1]=t=>r.value.size=t),"page-sizes":[10,20,50,100],total:r.value.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:i,onCurrentChange:i},null,8,["current-page","page-size","total"])])]),_:1})])}}}),G=j($,[["__scopeId","data-v-5fd2c608"]]);export{G as default};
