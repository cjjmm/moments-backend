<!--pages/search/search.wxml-->
<view class="container">
  <!-- æœç´¢æ¡† -->
  <view class="search-box">
    <input 
      class="search-input"
      placeholder="æœç´¢å†…å®¹..."
      value="{{keyword}}"
      bindinput="onInput"
      bindconfirm="doSearch"
    />
    <button class="search-btn" bindtap="doSearch">æœç´¢</button>
  </view>
  
  <!-- çƒ­é—¨æ ‡ç­¾ -->
  <view class="filter-section">
    <view class="section-title">çƒ­é—¨æ ‡ç­¾</view>
    <view class="tag-list">
      <view 
        class="tag-item {{tag === item.tagName ? 'active' : ''}}"
        wx:for="{{hotTags}}"
        wx:key="tagName"
        data-tag="{{item.tagName}}"
        bindtap="searchByTag"
      >
        #{{item.tagName}}
      </view>
    </view>
  </view>
  
  <!-- æ—¥æœŸç­›é€‰ -->
  <view class="filter-section">
    <view class="section-title">
      <text>æ—¥æœŸç­›é€‰</text>
      <text class="clear-btn" bindtap="clearDates" wx:if="{{startDate || endDate}}">æ¸…é™¤</text>
    </view>
    <view class="date-picker-row">
      <picker mode="date" value="{{startDate}}" bindchange="onStartDateChange">
        <view class="date-picker">
          <text>{{startDate || 'å¼€å§‹æ—¥æœŸ'}}</text>
        </view>
      </picker>
      <text class="date-separator">è‡³</text>
      <picker mode="date" value="{{endDate}}" bindchange="onEndDateChange">
        <view class="date-picker">
          <text>{{endDate || 'ç»“æŸæ—¥æœŸ'}}</text>
        </view>
      </picker>
    </view>
  </view>
  
  <!-- æœç´¢ç»“æœ -->
  <view class="results-section" wx:if="{{searched}}">
    <view class="section-title">æœç´¢ç»“æœ ({{results.length}})</view>
    
    <view class="result-list" wx:if="{{results.length > 0}}">
      <view 
        class="result-item"
        wx:for="{{results}}"
        wx:key="postId"
        data-id="{{item.postId}}"
        bindtap="goToDetail"
      >
        <view class="result-header">
          <image class="avatar" src="{{item.avatar || 'https://via.placeholder.com/60'}}" mode="aspectFill"></image>
          <view class="user-info">
            <text class="nickname">{{item.nickname || item.username}}</text>
            <text class="time">{{item.createTime}}</text>
          </view>
        </view>
        <text class="result-content">{{item.content}}</text>
        <view class="result-meta">
          <text class="media-type">{{item.mediaType === 'IMAGE' ? 'ğŸ–¼ï¸' : item.mediaType === 'VIDEO' ? 'ğŸ¬' : 'ğŸ“'}}</text>
          <text>ğŸ‘ {{item.likeCount || 0}}</text>
          <text>ğŸ’¬ {{item.commentCount || 0}}</text>
        </view>
      </view>
    </view>
    
    <!-- ç©ºç»“æœ -->
    <view class="empty" wx:else>
      <text class="empty-icon">ğŸ”</text>
      <text class="empty-text">æœªæ‰¾åˆ°ç›¸å…³å†…å®¹</text>
    </view>
  </view>
  
  <!-- åŠ è½½ä¸­ -->
  <view class="loading" wx:if="{{loading}}">
    <text>æœç´¢ä¸­...</text>
  </view>
</view>
